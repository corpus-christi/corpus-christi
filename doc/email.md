<h1 class="code-line" data-line-start=0 data-line-end=1 ><a id="Email_0"></a>Email</h1>
<p class="has-line-data" data-line-start="2" data-line-end="4">There are dozens of ways to send emails using standard python libraries, and different ones have different quirks and use cases depending on what you’re trying to do. I ended up using a combination of the default smtplib and MIME, for a variety of reasons. Emails have to be formatted and sent in a certain way with certain headers and formatting of the text. This is taken care of by MIME, which autoformats those headers and allows you to add new ones pretty easily (such as the optional “reply-to” header). Other mail libraries do similar things, some of them (like yagmail), had various problems such as allowing emails to be sent to multiple recipients but would often it would fail silently. Other libraries limited you to one type of attachment, where you used different parameters in functions to say you’re using an image or a doc (a long if statement chain could’ve solved this problem, but then you’re using other libraries to find out what type of doc it is, and that got complicated fast for dozens of possible filetypes). Many python smtp tutorials took the easiest possible path to get mail sent, often overlooking important things such as the SSL option for sending mail.<br>
As it stands, there are six command line arguments, all listed at the top of the file and are saved as strings. At time of writing this document, the recipients of the emails are to be passed in as a file path that points to a csv, which is then turned into a list. Some documentation claimed that a direct csv filepath should work, but I found better success turning the names into a list. Note that the csv is expecting only emails, not any other info like names of people the emails belong to, or a header such as “emails”.  In order to show the name of the sender outside of what’s attached to the sender email, you need to follow a “firstname lastname &lt;sender_email&gt;” format, which is already done in the code. Note that while you can make the name whatever you want, changing the sender email will not work. Gmail will automatically change it, as will all other mail services. You cannot change the sender email away from the church’s email. Replies to the emails are automatically sent to the email provided in the command line arguments.</p>
<p class="has-line-data" data-line-start="5" data-line-end="6">Note that if you intend to change to a new gmail account for the main sender, you have to change gmail settings to allow sending from third parties</p>
<p class="has-line-data" data-line-start="7" data-line-end="8">Current limitations: can only attach 1 attachment at a time, this shouldn’t be all that hard to fix. Password is hardcoded into the python file and can be taken out with keyring options or environmental variables at a later date.</p>
